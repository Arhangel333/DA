а б
а б
1
б

a b c 
a c b
1
a

a b c d 
a c b d
2
b d

Также важно: в функции lcs_length мы возвращаем вектор для всей строки B, но в функции hirschberg мы используем этот вектор для подстроки B? Надо убедиться, что индексы согласованы.